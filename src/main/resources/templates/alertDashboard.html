<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>Alerts</title>
<head th:include="templateListing :: headFragment"></head>

<!-- <link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">  -->
<link rel="stylesheet"
	th:href="@{/webtemplate/css/cloudfont-awesome.min.css}">
<link rel="stylesheet"
	th:href="@{/webtemplate/css/font-awesome.min.css}">
<style>
#page {
	/* 	background: #e3e6e7 url(/webtemplate/dist/img/canarispng.png) repeat; */
	color: #61686d;
	font: 14px "Helvetica Neue", Helvetica, Arial, Verdana, sans-serif;
	font-weight: lighter;
	padding-bottom: 60px;
}

#page {
	background: #ffffff;
	width: 878px;
	margin: 0 auto;
	margin-top: 80px;
	display: block;
	border: 1px solid #c4c7c7;
	padding: 40px 40px 120px 40px;
	position: relative;
	z-index: 0;
}

.page-shadow {
	/* 	background-image: url(images/page-shadow.png); */
	width: 992px;
	height: 60px;
	margin: 0 auto;
	margin-top: -1px;
	z-index: 1;
	position: relative;
}

#h1id {
	color: #4d5357;
	font-weight: lighter;
	font-size: 56px;
	margin: 40px 0 0 0;
}

.terms {
	float: left;
	width: 400px;
	margin: 0 0 40px 0;
	font-size: 12px;
	color: #a1a7ac;
	line-height: 180%;
}

.terms strong {
	font-size: 16px;
}

.recipient-address {
	padding-top: 60px;
	width: 200px;
}

.company-logoMy {
	/* 	width: 202px; */
	height: 81px;
	position: absolute;
	right: 40px;
	top: 40px;
}

.company-addressMy {
	width: 200px;
	color: #a1a7ac;
	position: absolute;
	right: 40px;
	top: 130px;
	text-align: right;
	font-size: 16px;
}

.status {
	position: absolute;
	top: -5px;
	left: -5px;
	text-indent: -5000px;
	width: 128px;
	height: 128px;
}

/* .draft { */
/* 	background-image: url(images/status-draft.png); */
/* } */

/* .sent { */
/* 	background-image: url(images/status-sent.png); */
/* } */

/* .paid { */
/* 	background-image: url(images/status-paid.png); */
/* } */

/* .overdue { */
/* 	background-image: url(images/status-overdue.png); */
/* } */
hr {
	clear: both;
	border: none;
	background: none;
	border-bottom: 1px solid #d6dde2;
}

.pay-buttons {
	text-align: center;
	width: 400px;
	margin: 0 auto;
	margin-top: 20px;
}

/* .pay-paypal { */
/* 	display: block; */
/* 	width: 200px; */
/* 	height: 45px; */
/* 	background: url('images/pay-buttons.png') no-repeat; */
/* 	text-indent: -5000px; */
/* 	background-position: 0 0; */
/* 	float: left; */
/* } */
.pay-paypal:hover {
	background-position: 0 -45px;
}

.pay-paypal:active {
	background-position: 0 -90px;
}

.pay-card {
	display: block;
	float: left;
	width: 165px;
	height: 45px;
	/* 	background: url('images/pay-buttons.png') no-repeat; */
	text-indent: -5000px;
	background-position: -200px 0;
}

.pay-card:hover {
	background-position: -200px -45px;
}

.pay-card:active {
	background-position: -200px -90px;
}

.total-due {
	float: right;
	width: 200px;
	border: 1px solid #d6dde2;
	margin: 0 0 40px 0;
	padding: 0;
	border-radius: 3px;
	-moz-border-radius: 3px;
	-webkit-border-radius: 3px;
	text-align: right;
}

.total-heading {
	background: #e7ebee;
	height: 24px;
	color: #63676b;
	text-shadow: 0 1px 1px #ffffff;
	padding: 8px 20px 0 0;
	-moz-box-shadow: 0 2px 2px rgba(0, 0, 0, 0.1);
	-webkit-box-shadow: 0 2px 2px rgba(0, 0, 0, 0.1);
	box-shadow: inset 0px 0px 0px 1px rgba(255, 255, 255, 0.5), 0 2px 2px
		rgba(0, 0, 0, 0.08);
	border-bottom: 1px solid #d6dde2;
	font-weight: bold;
}

.total-heading p, .total-amount p {
	margin: 0;
	padding: 0;
}

.total-amount {
	padding: 15px 20px 15px 0;
	color: #4d5357;
	font-size: 32px;
}

#tableinvoiceperticular.tablesorter {
	width: 100%;
	text-align: left;
	border: 1px solid #d6dde2;
	border-radius: 3px;
	-moz-border-radius: 3px;
	-webkit-border-radius: 3px;
	margin: 40px 0;
	color: #a1a7ac;
}

#tableinvoiceperticular.tablesorter thead tr th, #tableinvoiceperticular.tablesorter tfoot tr th
	{
	margin: 0;
}

#tableinvoiceperticular.tablesorter thead tr .header {
	/* 	background: #e7ebee url(images/arrows-both.png) no-repeat center right; */
	cursor: pointer;
	height: 60px;
	color: #63676b;
	text-shadow: 0 1px 1px #ffffff;
	padding-left: 20px;
	-moz-box-shadow: 0 2px 2px rgba(0, 0, 0, 0.1);
	-webkit-box-shadow: 0 2px 2px rgba(0, 0, 0, 0.1);
	box-shadow: inset 0px 0px 0px 1px rgba(255, 255, 255, 0.5), 0 2px 2px
		rgba(0, 0, 0, 0.08);
	border-bottom: 1px solid #d6dde2;
}

#tableinvoiceperticular.tablesorter tbody td {
	padding: 20px;
	vertical-align: top;
}

#tableinvoiceperticular.tablesorter tbody tr.even td {
	background: #f6f8f9;
}

#tableinvoiceperticular.tablesorter thead tr .headerSortUp {
	/* 	background-image: url(images/arrow-up.png); */
	
}

#tableinvoiceperticular.tablesorter thead tr .headerSortDown {
	/* 	background-image: url(images/arrow-down.png); */
	
}

#tableinvoiceperticular.tablesorter thead tr .headerSortDown,
	#tableinvoiceperticular.tablesorter thead tr .headerSortUp {
	
}

.stripemy {
	border-bottom: 1px solid #000;
	border-top: 1px solid #000;
}

/* .multiselect-with-padding { */
/* 	padding: 1%; /* Adjust the padding value as needed */
*
/
/* } */
</style>
</head>
<body class="hold-transition sidebar-mini layout-fixed">
	<div class="wrapper">
		<div th:replace="fragments/header_bk :: header"></div>
		<div th:replace="fragments/sidebar :: aside"></div>
		<div class="content-wrapper">
			<section class="content-header">
				<div class="container-fluid">
					<div class="row mb-2">
						<div class="col-sm-6">
							<h1>Alerts&nbsp;([[${AlertListObj.size()}]])</h1>
						</div>
						<!-- 						<div class="col-sm-6"> -->
						<!-- 							<ol class="breadcrumb float-sm-right"> -->
						<!-- 								<li class="breadcrumb-item"><a href="#">Home</a></li> -->
						<!-- 								<li class="breadcrumb-item active">Billing Master</li> -->
						<!-- 							</ol> -->
						<!-- 						</div> -->
					</div>
				</div>
			</section>

			<section class="content">
				<div class="container-fluid">

					<form th:action="${'/report/AlertDashboardFilter'}"
						th:method="POST" onsubmit="return validateForm()">

						<div class="row">

							<div class="col-md-4">
								<!-- 								<div class="form-group"> -->
								<div class="input-group">
									<button type="button" class="btn btn-default float-right"
										id="daterange-btn" name="daterange-btn">
										<i class="far fa-calendar-alt"></i> Date range picker <i
											class="fas fa-caret-down"></i>
									</button>
									<input type="text" id='from_date' name='from_date' required
										class="form-control" readonly /> <input type="text"
										id='to_date' required name='to_date' class="form-control"
										readonly />
								</div>
								<!-- 								</div> -->
							</div>
							<div class="col-md-4">
								<!-- 								<div class="form-group"> -->




								<select tabindex="1" id="sevrity" required name="sevrity"
									multiple="multiple" class="form-control"
									style="width: 100%; opacity: 0;">
									<option value="High">High</option>
									<option value="Medium">Medium</option>
									<option value="Low">Low</option>
								</select>





								<!-- 								</div> -->
							</div>
							<div class="col-md-4">
								<button type="submit" id="vmActivityBtn" class="btn btn-info">
									Generate <i
										style="margin-left: 10px; color: yellow; display: none"
										id="reportSpinner" class='fa fa-spinner fa-spin'></i>
								</button>
							</div>

						</div>
					</form>
					<br>
					<div class="row">
						<span th:if="${fdate != 'blank'}">&nbsp;&nbsp;<b>Showing
								Data</b>&nbsp; &nbsp; &nbsp;<b>From Date :</b> [[${fdate}]]
						</span> <span th:if="${tdate != 'blank'}"> <b>&nbsp; &nbsp;
								&nbsp;To Date :</b> [[${tdate}]]
						</span> <span th:if="${fdate == 'blank'}"> &nbsp;&nbsp;<b>Showing
								Data</b>&nbsp; &nbsp; &nbsp;<b>For Today</b>
						</span>
					</div>
					<br>
					<div class="row">
						<div class="col-xl-3 col-lg-6" th:each="alert : ${AlertListObj}"
							style="padding-bottom: 2%;">
							<!-- 					danger card -->
							<div th:if="${alert.alert_STATUS == 'High'}">
								<div class="card card-stats mb-4 mb-xl-0"
									style="border: solid 0.3em #ffd70000; border-left-color: red; /* From https: //css.glass */ background: rgb(0 0 0/ 9%); border-radius: 5px; box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1); backdrop-filter: blur(8.4px); -webkit-backdrop-filter: blur(8.4px);">
									<div class="card-body">
										<div class="row">
											<div class="col">
												<h5 class="card-title text-uppercase text-muted mb-0"
													style="font-weight: bolder !important;">[[${alert.alert_Name}]]</h5>
												&nbsp;<span class="text-uppercase text-muted mb-0"
													style="font-weight: bolder !important;">(</span> <span
													class="text-uppercase text-muted mb-0"
													style="font-weight: bolder !important;">[[${alert.alert_STATUS}]]</span>
												<span class="text-uppercase text-muted mb-0"
													style="font-weight: bolder !important;">)</span> <br>
												<span class="h2 font-weight-bold mb-0"
													th:text="${#numbers.formatDecimal(alert.MEMORY_UTILIZATION, 2, 2)}">[[${alert.MEMORY_UTILIZATION}]]
												</span><span style="font-weight: bold; font-size: 1.1rem;">
													% Utilized</span>
											</div>
											<div class="col-auto">
												<i class="fa fa-3x fa-exclamation-triangle"
													style="color: #ff4444;"></i>
											</div>
										</div>
										<p class="mt-3 mb-0 text-muted text-base"
											style="font-weight: bold !important;">
											<span class="text-nowrap">VM : [[${alert.VM_Name}]]</span><br>
											<i class="fa"
												th:classappend="${alert.difference < 0} ? 'fa-arrow-down' : 'fa-arrow-up'"
												style="color: #cc0000;"></i>&nbsp; <span
												style="color: #cc0000;"
												th:text="${#numbers.formatDecimal(alert.difference, 2, 2)}">[[${alert.difference}]]</span>
											<span style="color: #cc0000;">%</span> <span
												class="text-nowrap">Time :
												[[${alert.EVENT_TIMESTAMP}]]</span>
										</p>
									</div>
								</div>
							</div>

							<!-- 						warning card -->
							<div th:if="${alert.alert_STATUS == 'Medium'}">
								<div class="card card-stats mb-4 mb-xl-0"
									style="border: solid 0.3em #ffd70000; border-left-color: #ffbb33; /* From https: //css.glass */ background: rgb(0 0 0/ 9%); border-radius: 5px; box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1); backdrop-filter: blur(8.4px); -webkit-backdrop-filter: blur(8.4px);">
									<div class="card-body">
										<div class="row">
											<div class="col">
												<h5 class="card-title text-uppercase text-muted mb-0"
													style="font-weight: bolder !important;">[[${alert.alert_Name}]]</h5>
												&nbsp;<span class="text-uppercase text-muted mb-0"
													style="font-weight: bolder !important;">(</span> <span
													class="text-uppercase text-muted mb-0"
													style="font-weight: bolder !important;">[[${alert.alert_STATUS}]]</span>
												<span class="text-uppercase text-muted mb-0"
													style="font-weight: bolder !important;">)</span> <br>
												<span class="h2 font-weight-bold mb-0"
													th:text="${#numbers.formatDecimal(alert.MEMORY_UTILIZATION, 2, 2)}">[[${alert.MEMORY_UTILIZATION}]]
												</span><span style="font-weight: bold; font-size: 1.1rem;">
													% Utilized</span>
											</div>
											<div class="col-auto">
												<i class="fa-3x fa fa-exclamation-circle"
													style="color: #ffbb33;"></i>
											</div>
										</div>
										<p class="mt-3 mb-0 text-muted text-base"
											style="font-weight: bold !important;">
											<span class="text-nowrap">VM : [[${alert.VM_Name}]]</span><br>
											<i class="fa"
												th:classappend="${alert.difference < 0} ? 'fa-arrow-down' : 'fa-arrow-up'"
												style="color: #ff8800;"></i>&nbsp; <span
												style="color: #ff8800;"
												th:text="${#numbers.formatDecimal(alert.difference, 2, 2)}">[[${alert.difference}]]</span>
											<span style="color: #ff8800;">%</span> <span
												class="text-nowrap">Time :
												[[${alert.EVENT_TIMESTAMP}]]</span>
										</p>
									</div>
								</div>
							</div>

							<!-- 						Info card -->
							<div th:if="${alert.alert_STATUS == 'Low'}">
								<div class="card card-stats mb-4 mb-xl-0"
									style="border: solid 0.3em #ffd70000; border-left-color: #33b5e5; /* From https: //css.glass */ background: rgb(0 0 0/ 9%); border-radius: 5px; box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1); backdrop-filter: blur(8.4px); -webkit-backdrop-filter: blur(8.4px);">
									<div class="card-body">
										<div class="row">
											<div class="col">
												<h5 class="card-title text-uppercase text-muted mb-0"
													style="font-weight: bolder !important;">[[${alert.alert_Name}]]</h5>
												&nbsp;<span class="text-uppercase text-muted mb-0"
													style="font-weight: bolder !important;">(</span> <span
													class="text-uppercase text-muted mb-0"
													style="font-weight: bolder !important;">[[${alert.alert_STATUS}]]</span>
												<span class="text-uppercase text-muted mb-0"
													style="font-weight: bolder !important;">)</span> <br>
												<span class="h2 font-weight-bold mb-0"
													th:text="${#numbers.formatDecimal(alert.MEMORY_UTILIZATION, 2, 2)}">[[${alert.MEMORY_UTILIZATION}]]
												</span><span style="font-weight: bold; font-size: 1.1rem;">
													% Utilized</span>
											</div>
											<div class="col-auto">
												<i class="fa-3x fa fa-exclamation" style="color: #33b5e5;"></i>
											</div>
										</div>
										<p class="mt-3 mb-0 text-muted text-base"
											style="font-weight: bold !important;">
											<span class="text-nowrap">VM : [[${alert.VM_Name}]]</span><br>
											<i class="fa"
												th:classappend="${alert.difference < 0} ? 'fa-arrow-down' : 'fa-arrow-up'"
												style="color: #0099cc;"></i>&nbsp; <span
												style="color: #0099cc;"
												th:text="${#numbers.formatDecimal(alert.difference, 2, 2)}">[[${alert.difference}]]</span>
											<span style="color: #0099cc;">%</span> <span
												class="text-nowrap">Time :
												[[${alert.EVENT_TIMESTAMP}]]</span>
										</p>
									</div>
								</div>
							</div>


							<!-- 						</div> -->
						</div>

					</div>
				</div>
			</section>

		</div>

		<div th:replace="fragments/footer :: footer"></div>
	</div>
	<div th:replace="template :: jsscript"></div>
	<!-- 	<div th:replace="templateListing :: jsscript"></div> -->
	<!-- 	<script type="text/javascript" -->
	<!-- 		th:src="@{/custom_js/datatable.checkbox.min.js}"></script> -->

	<script
		th:src="@{/webtemplate/multiselect/bootstrap-multiselect.min.js}"></script>


	<script type="text/javascript">
		$(document).ready(
				function() {
					$(".btn-delete").on(
							"click",
							function(e) {
								e.preventDefault();
								link = $(this);

								tutorialTitle = link.attr("tutorialTitle");
								$("#yesBtn").attr("href", link.attr("href"));
								$("#confirmText").html(
										"Do you want to delete the Location \<strong\>"
												+ tutorialTitle
												+ "\<\/strong\>?");
								$("#confirmModal").modal();
							});

					$("#btnClear").on("click", function(e) {
						e.preventDefault();
						$("#keyword").text("");
						window.location = "[[@{/discount/view}]]";
					});
					
					$('#sevrity').multiselect({
						enableFiltering: true,
						includeSelectAllOption: true,
						buttonWidth: '100%',
						maxHeight: 350,
						  nonSelectedText: 'Please Select Severity',
// 						  buttonClass: 'form-control multiselect-with-padding'

					});
					$('#sevrity').keyup(function(){
				        var instance = $(this).val();
				        if(instance != ''){
				        	this.setCustomValidity('');
				            $('#vmActivityBtn').prop('disabled', false);
				        } else {
				        	this.setCustomValidity('Please Select Severity');
				        }
				    });
				});
	</script>
	<script type="text/javascript">
	
	
		function ViewInvoice() {

			$("#InVoiceModal").modal('show');

		}

		function printDiv(divId) {
			var divContents = $(divId).html();
			var printWindow = window.open('', '', 'height=800,width=800');
			printWindow.document.write('<html><head><title>invoive</title>');
			printWindow.document
					.write('<link href="/webtemplate/plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css" rel="stylesheet">');
			printWindow.document.write('<style>');
			printWindow.document
					.write('body { font-family: Arial, sans-serif; }');
			printWindow.document.write('' + $('style').html() + '');
			printWindow.document.write('</style>');
			printWindow.document.write('</head><body>');
			printWindow.document.write('<div id="page">');
			printWindow.document.write(divContents);
			printWindow.document.write('</div>');
			printWindow.document.write('</body></html>');
			printWindow.document.close();
			printWindow.print();
		}
		
//	     daterange validation


		function validateForm(){
				 var fromDate = document.getElementById('from_date').value;
			        var toDate = document.getElementById('to_date').value;

			        // Validate from_date and to_date
			        if (fromDate === "" || toDate === "") {
			        	Swal.fire({
							position: 'top',
							icon: 'warning',
							title: 'Please select Start and End Dates',
							showConfirmButton: false,
							timer: 3000
						})
			            return false;
			        }
			        
// 			        var severitySelect = document.getElementById("sevrity");
			        
// 			        if (severitySelect.style.display === "none") {
// 			            severitySelect.style.display = "block";  // Make it visible
// 			        }

			}
	</script>
	<script th:inline="javascript">
	
	var listObjJs = [[${listObj}]];
	
	function generateinvoiceOnclick(){
		
		 document.getElementById('InvoiceTablebodyID').innerHTML = "";
		 document.getElementById('amountduepriceID').innerHTML = '';
		 document.getElementById('h1id').innerHTML = '';
		 document.getElementById('DateWithToAdressID').innerHTML = '';
		
		let increment=0;
		var htmlhere="";
		let totalUsagePrice = 0;
		let totalDiscountedPrice = 0;
		
		 for (var i = 0; i < listObjJs.length; i++) {
			 
			 increment++;
			
			 
			 if (increment % 2 === 0) {
// 				    console.log("The increment value is even.");
				    htmlhere+='<tr class="even">';
				} else {
// 				    console.log("The increment value is odd.");
				    htmlhere+='<tr class="odd">';
				}
		        var obj = listObjJs[i];
		        totalUsagePrice += obj.usagePrice;
				 totalDiscountedPrice+= obj.discountedPrice;
// 		        console.log("ID: " + obj.id);
// 		        console.log("VM Name: " + obj.per_Hour_PRice);
		        
		        htmlhere += '<td>Cloud Server (<span style="font-weight: bold;">'+obj.vm_Name+'</span>)<br>';
		        htmlhere += '<span style="font-weight: bold; color: #808080a1;">'+obj.vcpu+' / RAM '+obj.ram+' / SSD '+obj.ssd_Disk+'</span>';
		        htmlhere += '</td>';
		        htmlhere += '<td>'+obj.vm_Usage+' Hours</td>';
		        htmlhere += '<td>₹'+new Intl.NumberFormat('en-IN').format(obj.usagePrice)+'</td>';
		        htmlhere += '<td><span style="color: #444444;">₹'+new Intl.NumberFormat('en-IN').format(obj.discountedPrice)+' </span><br>';
		        htmlhere += '<span style="color: #808080a1; border-top: 1px solid #00000026;">Discount type : '+obj.discount_Type+'</span><br>';
		        htmlhere += '<span style="color: #808080a1;">Discount : '+obj.discount_percentage+'%</span>';
		        htmlhere += '</td>';
		        htmlhere += '</tr>';
		        // skip after
		        
		        
		    }
		 
		 htmlhere += '<tr class="odd">';
		 htmlhere += '<td></td>';
		 htmlhere += '<td></td>';
		 htmlhere += '<td></td>';
		 htmlhere += '<td></td>';
		 htmlhere += '</tr>';

		 htmlhere += '<tr class="even stripemy">';
		 htmlhere += '<td></td>';
		 htmlhere += '<td></td>';
		 htmlhere += '<td><span style="font-weight: bold; font-size: 15px;">SubTotal</span></td>';
		 htmlhere += '<td><span style="font-weight: bold; font-size: 17px;">₹'+new Intl.NumberFormat('en-IN').format(totalUsagePrice)+'</span></td>';
		 htmlhere += '</tr>';

		 htmlhere += '<tr class="even stripemy">';
		 htmlhere += '<td></td>';
		 htmlhere += '<td></td>';
		 htmlhere += '<td><span style="font-weight: bold; font-size: 15px;">You Saved</span></td>';
		 htmlhere += '<td><span style="font-weight: bold; font-size: 17px;">₹'+new Intl.NumberFormat('en-IN').format((parseFloat(totalUsagePrice) - parseFloat(totalDiscountedPrice)))+'</span></td>';
		 htmlhere += '</tr>';

		 htmlhere += '<tr class="even stripemy">';
		 htmlhere += '<td></td>';
		 htmlhere += '<td></td>';
		 htmlhere += '<td><span style="font-weight: bold; font-size: 15px;">Total</span></td>';
		 htmlhere += '<td><span style="font-weight: bold; font-size: 17px;">₹'+new Intl.NumberFormat('en-IN').format(totalDiscountedPrice)+'</span></td>';
		 htmlhere += '</tr>';
		
		 document.getElementById('InvoiceTablebodyID').innerHTML = htmlhere;
		 	 
		 document.getElementById('amountduepriceID').innerHTML = '<p>₹'+new Intl.NumberFormat('en-IN').format(totalDiscountedPrice)+'</p>';
		 
		 let randomNumber = Math.floor(Math.random() * 900) + 100;
		 
		 
		 document.getElementById('h1id').innerHTML = 'Invoice #00'+randomNumber+'';
		 
		 var today = new Date();
		var options = { year: 'numeric', month: 'long', day: '2-digit' };
		var formattedDate = today.toLocaleDateString('en-IN', options);
		
		 var htmltoadress ='<p class="terms">' 
			 +'<strong>Generation Date : '+formattedDate+'</strong>'
             + '<br>To,<br>'
             + 'User Name,<br>'
             + 'Address Line<br>'
             + 'GSTIN:22AAAAA0000A1Z5'
             +'</p>';
         
             
             document.getElementById('DateWithToAdressID').innerHTML = htmltoadress;
    		 
		 
		 $("#InVoiceModal").modal('show');
	}
	

    
    /* Iterate over the listObj and process each item */
    
    

   
	
	</script>
</body>

</html>