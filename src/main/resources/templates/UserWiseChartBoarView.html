<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Cloud Portal</title>
<link rel="icon" type="image/png"
	href="/webtemplate/dist/img/magicboxEye3.png">
<link rel="stylesheet"
	th:href="@{/webtemplate/plugins/fontawesome-free/css/all.min.css}">
<!-- Ionicons -->
<link rel="stylesheet" th:href="@{/css/ionicIcons.css}">
<!-- Tempusdominus Bootstrap 4 -->
<link rel="stylesheet"
	th:href="@{/webtemplate/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css}">
<!-- iCheck -->
<link rel="stylesheet"
	th:href="@{/webtemplate/plugins/icheck-bootstrap/icheck-bootstrap.min.css}">
<!-- JQVMap -->
<link rel="stylesheet"
	th:href="@{/webtemplate/plugins/jqvmap/jqvmap.min.css}">
<!-- Theme style -->
<link rel="stylesheet"
	th:href="@{/webtemplate/dist/css/adminlte.min.css}">
<!-- overlayScrollbars -->
<link rel="stylesheet"
	th:href="@{/webtemplate/plugins/overlayScrollbars/css/OverlayScrollbars.min.css}">
<!-- Daterange picker -->
<link rel="stylesheet"
	th:href="@{/webtemplate/plugins/daterangepicker/daterangepicker.css}">
<!-- summernote -->
<link rel="stylesheet"
	th:href="@{/webtemplate/plugins/summernote/summernote-bs4.min.css}">
<link rel="stylesheet" type="text/css"
	th:href="@{/webtemplate/plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css}">

<!--End Common CSS  -->

<!-- <link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">  -->
<link rel="stylesheet"
	th:href="@{/webtemplate/css/cloudfont-awesome.min.css}">
<link rel="stylesheet"
	th:href="@{/webtemplate/css/font-awesome.min.css}">
<link rel="stylesheet"
	th:href="@{/webtemplate/plugins/select2/css/select2.min.css}">
<link rel="stylesheet"
	th:href="@{/webtemplate/plugins/select2-bootstrap4-theme/select2-bootstrap4.min.css}">
<link rel="stylesheet"
	th:href="@{/webtemplate/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css}">
<link rel="stylesheet"
	th:href="@{/webtemplate/plugins/datatables-responsive/css/responsive.bootstrap4.min.css}">
<link rel="stylesheet"
	th:href="@{/webtemplate/plugins/datatables-buttons/css/buttons.bootstrap4.min.css}">




<style type="text/css">
.start-btn {
	background: linear-gradient(90deg, #16a34a, #22c55e);
	color: #fff;
	padding: 6px 16px;
	border-radius: 20px;
	font-size: 0.9rem;
	font-weight: 600;
	text-decoration: none;
	display: inline-flex;
	align-items: center;
	gap: 6px;
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
	transition: all 0.3s ease;
}

.start-btn:hover {
	background: linear-gradient(90deg, #15803d, #16a34a);
	transform: translateY(-2px);
	box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
	text-decoration: none;
}

.start-btn i {
	font-size: 0.9rem;
}

.text-center {
	text-align: center !important;
}

/* Style for the span */
.glow-span {
	display: inline-block;
	padding: 10px;
	background-color: #fff;
	/* border: 1px solid #ccc; */
	transition: box-shadow 0.3s;
	border-radius: 10px;
	width: -webkit-fill-available;
	text-align: center;
}

.glow-span:hover {
	box-shadow: 0 0 10px 5px rgba(0, 0, 255, 0.5);
	background-color: blue;
	/* Blue glow effect */
}

.glow-span2 {
	display: inline-block;
	padding: 10px;
	background-color: #ffc700;
	/* border: 1px solid #ccc; */
	transition: box-shadow 0.3s;
	border-radius: 10px;
	width: -webkit-fill-available;
	text-align: center;
}

.glow-span2:hover {
	box-shadow: 0 0 10px 5px rgba(0, 0, 255, 0.5);
	background-color: #ffc700;
}

/* right click context menu */
* {
	margin: 0px;
	padding: 0px;
	box-sizing: border-box;
}

ul li {
	list-style: none;
}

#contextMenu {
	position: absolute;
	transform-origin: top left;
	transform: scale(0);
	width: 220px;
	border: 1px solid rgba(100, 100, 100, 0.55);
	padding: 5px;
	background: rgba(250, 250, 250, 0.98);
	box-shadow: 2px 2px 12px 4px rgba(100, 100, 100, 0.4);
	transition: transform 400ms ease-in-out 50ms;
}

#contextMenu.visible {
	transform: scale(1);
}

#contextMenu ul li {
	padding: 5px 3px;
	display: flex;
	align-items: center;
	cursor: pointer;
	color: rgba(50, 50, 50, 0.9);
	font-size: 15px;
}

#contextMenu ul li:hover {
	background: rgba(100, 100, 100, 0.12);
}

#contextMenu ul li.disabled {
	color: rgba(100, 100, 100, 0.5);
	cursor: pointer;
}

#contextMenu ul li.share {
	/*   height:40px; */
	width: 100%;
	flex-direction: column;
	align-items: left;
	flex-wrap: wrap;
}

#contextMenu ul li.share>.name {
	margin-top: -2px;
	margin-bottom: 10px;
	display: block;
}

#contextMenu ul li.share .icons {
	width: 100%;
	display: flex;
	justify-content: space-around;
}

#contextMenu ul li.share .icons>i:hover {
	background: #e7e7e7;
}

#contextMenu ul li i {
	width: 20px;
}

#contextMenu ul li div.name {
	padding-left: 8px;
}

#contextMenu div.break {
	margin: 4px 0px;
	border-top: 1px solid rgba(100, 100, 100, 0.5);
}

#pulse {
	position: fixed;
	width: 35px;
	height: 35px;
	background: rgba(0, 0, 0, 1);
	opacity: 0;
	border-radius: 50%;
	z-index: 100;
}

#pulse.active {
	animation: pulse 400ms ease;
}

@
keyframes pulse { 0% {
	opacity: 1;
	transform: scale(0);
}

100




%
{
opacity


















:










					









0




;
transform


















:










					









scale









 









(




1




.1


















)




;
}
}
th {
	text-align: center;
}

td {
	text-align: center;
}

.dropdown-menu {
	padding: 5px;
	min-width: 16rem !important;
}

#dropdownMenuButton {
	min-width: 1em;
	color: #fff;
}

/* CSS for page loader */
/* ---- Page loader overlay ---- */
.loader-overlay {
	position: fixed;
	inset: 0; /* top:0 right:0 bottom:0 left:0 */
	display: grid;
	place-items: center; /* perfect centering */
	background: rgba(0, 0, 0, 0.4);
	backdrop-filter: blur(2px);
	/* subtle polish (ignored if unsupported) */
	z-index: 9999;
}

/* ---- Spinner ---- */
.spinner {
	width: 64px;
	height: 64px;
	border-radius: 50%;
	border: 6px solid #e6e6e6; /* track */
	border-top-color: #2563eb; /* indicator */
	animation: spin 0.9s linear infinite;
}

@
keyframes spin {to { transform:rotate(360deg);
	
}

}

/* Optional loading text */
.loader-text {
	margin-top: 14px;
	color: #ffffff;
	font: 500 14px/1.2 system-ui, -apple-system, Segoe UI, Roboto,
		sans-serif;
	text-shadow: 0 1px 2px rgba(0, 0, 0, .45);
	letter-spacing: .2px;
}

/* Respect users who prefer reduced motion */
@media ( prefers-reduced-motion : reduce) {
	.spinner {
		animation: none;
		border-top-color: #2563eb;
	}
}

/* Demo content area */
.page-content {
	min-height: 100vh;
	display: grid;
	place-items: center;
}
</style>
</head>

<body class="hold-transition sidebar-mini layout-fixed">
	<div class="wrapper">
		<!-- Header -->
		<div th:replace="fragments/header_bk :: header"></div>
		<!--Close Header -->

		<!-- Sidebar -->
		<div th:replace="fragments/sidebar :: aside"></div>
		<!-- Close Sidebar -->

		<!-- Page Loader -->
		<div id="pageLoader" class="loader-overlay" role="status"
			aria-live="polite" style="display: none" aria-label="Page loading">
			<div>
				<div class="spinner" aria-hidden="true"></div>
				<div class="loader-text">Loading…</div>
			</div>
		</div>
		<!-- End Page Loader -->

		<div class="content-wrapper">
			<!-- Page Header -->
			<section class="content-header">
				<div class="container-fluid">
					<div class="row mb-2">
						<div class="col-sm-6">
							<h1>User Wise Edit Instruction and Command</h1>
						</div>
						<div class="col-sm-6">
							<ol class="breadcrumb float-sm-right">
								<li class="breadcrumb-item"><a href="#">Home</a></li>
								<li class="breadcrumb-item active">User Wise Edit
									Instruction and Command</li>
							</ol>
						</div>
					</div>
				</div>
			</section>

			<!-- Page Content -->
			<section class="content">
				<div class="container-fluid">
					<div class="row">
						<div class="col-12">
							<div class="card card-secondary">
								<div class="card-header">
									<h3 class="card-title" style="padding-top: 10px">User Wise
										Edit Instruction and Command</h3>
								</div>
								<div class="card-body">
									<table id="userPerformanceTable"
										class="table table-bordered table-striped">
										<thead class="thead-light">
											<tr>
												<th>Sr No.</th>
												<th>User Name</th>
												<th>Template Name</th>
												<th>Lab Name</th>
												<th>Action</th>
											</tr>
										</thead>
										<tbody>
											<tr th:each="row : ${listObj}">
												<td th:text="${row.srNo}"></td>
												<td th:text="${row.userName}"></td>
												<td th:text="${row.templateName}"></td>
												<td th:text="${row.labName}"></td>
												<td th:utext="${row.action}"></td>
											</tr>
										</tbody>
									</table>

								</div>
							</div>
						</div>
					</div>
				</div>
			</section>
		</div>

	</div>
	<div class="modal fade" id="instructionModal" tabindex="-1"
		role="dialog">
		<div class="modal-dialog modal-lg" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Edit Setup Instructions</h5>
					<button type="button" class="close" data-dismiss="modal">&times;</button>
				</div>
				<div class="modal-body" id="instructionModalBody">
					
				</div>
			</div>
		</div>
	</div>


	
	<!-- Footer -->
	<div th:replace="fragments/footer :: footer"></div>
	<!--Close Footer -->

	<!-- ./wrapper -->

	<!-- Common JS  -->
	<!-- jQuery -->
	<script th:src="@{/webtemplate/plugins/jquery/jquery.min.js}"></script>
	<!-- jQuery UI 1.11.4 -->
	<script th:src="@{/webtemplate/plugins/jquery-ui/jquery-ui.min.js}"></script>

	<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
	<script>
		$.widget.bridge('uibutton', $.ui.button)
	</script>
	<!-- Bootstrap 4 -->
	<script
		th:src="@{/webtemplate/plugins/bootstrap/js/bootstrap.bundle.min.js}"></script>
	<!-- ChartJS -->
	<script th:src="@{/webtemplate/plugins/chart.js/Chart.min.js}"></script>
	<!-- Sparkline -->
	<!-- 	<script th:src="@{/webtemplate/plugins/sparklines/sparkline.js}"></script> -->
	<!-- JQVMap -->
	<!-- <script th:src="@{/webtemplate/plugins/jqvmap/jquery.vmap.min.js}"></script>
	<script th:src="@{/webtemplate/plugins/jqvmap/maps/jquery.vmap.usa.js}"></script> -->
	<!-- jQuery Knob Chart -->
	<script th:src="@{/webtemplate/plugins/jquery-knob/jquery.knob.min.js}"></script>
	<!-- daterangepicker -->
	<script th:src="@{/webtemplate/plugins/moment/moment.min.js}"></script>
	<script
		th:src="@{/webtemplate/plugins/daterangepicker/daterangepicker.js}"></script>
	<!-- Tempusdominus Bootstrap 4 -->
	<script
		th:src="@{/webtemplate/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js}"></script>
	<!-- Summernote -->
	<script
		th:src="@{/webtemplate/plugins/summernote/summernote-bs4.min.js}"></script>
	<!-- overlayScrollbars -->
	<script
		th:src="@{/webtemplate/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js}"></script>
	<!-- AdminLTE App -->
	<script th:src="@{/webtemplate/dist/js/adminlte.js}"></script>
	<!-- AdminLTE for demo purposes -->
	<script th:src="@{/webtemplate/dist/js/demo.js}"></script>
	<!-- AdminLTE dashboard demo (This is only for demo purposes) -->
	<!-- <script th:src="@{/webtemplate/dist/js/pages/dashboard.js}"></script> -->
	<!--End Common JS  -->

	<script
		th:src="@{/webtemplate/plugins/jquery-validation/jquery.validate.min.js}"></script>
	<script
		th:src="@{/webtemplate/plugins/jquery-validation/additional-methods.min.js}"></script>
	<script th:src="@{/webtemplate/plugins/sweetalert2/sweetalert2.min.js}"></script>
	<script th:src="@{/webtemplate/plugins/select2/js/select2.full.min.js}"></script>

	<script
		th:src="@{/webtemplate/plugins/datatables/jquery.dataTables.min.js}"></script>
	<script
		th:src="@{/webtemplate/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js}"></script>
	<script
		th:src="@{/webtemplate/plugins/datatables-responsive/js/dataTables.responsive.min.js}"></script>
	<script
		th:src="@{/webtemplate/plugins/datatables-responsive/js/responsive.bootstrap4.min.js}"></script>
	<script
		th:src="@{/webtemplate/plugins/datatables-buttons/js/dataTables.buttons.min.js}"></script>
	<script
		th:src="@{/webtemplate/plugins/datatables-buttons/js/buttons.bootstrap4.min.js}"></script>
	<script th:src="@{/webtemplate/plugins/jszip/jszip.min.js}"></script>
	<script th:src="@{/webtemplate/plugins/pdfmake/pdfmake.min.js}"></script>
	<script th:src="@{/webtemplate/plugins/pdfmake/vfs_fonts.js}"></script>
	<script
		th:src="@{/webtemplate/plugins/datatables-buttons/js/buttons.html5.min.js}"></script>
	<script
		th:src="@{/webtemplate/plugins/datatables-buttons/js/buttons.print.min.js}"></script>
	<script
		th:src="@{/webtemplate/plugins/datatables-buttons/js/buttons.colVis.min.js}"></script>
	<script th:src="@{/webtemplate/plugins/sweetalert2/sweetalert2.min.js}"></script>

	<script th:src="@{/custom_js/cloudServer.js}"></script>

	<script type="text/javascript"
		th:src="@{/custom_js/datatable.checkbox.min.js}"></script>

	<script type="text/javascript">
		$(document).ready(
			function () {
				$(".btn-delete").on(
					"click",
					function (e) {
						e.preventDefault();
						link = $(this);

						tutorialTitle = link.attr("tutorialTitle");
						$("#yesBtn").attr("href", link.attr("href"));
						$("#confirmText").html(
							"Do you want to delete the VM \<strong\>"
							+ tutorialTitle
							+ "\<\/strong\>?");
						$("#confirmModal").modal();
					});

				$("#btnClear").on("click", function (e) {
					e.preventDefault();
					$("#keyword").text("");
					window.location = "[[@{/'+${action_name}+'/view}]]";
				});
			});
	</script>

	<script type="text/javascript">
		$(function () {
			//Initialize Select2 Elements
			$('.select2').select2()

			//Initialize Select2 Elements
			$('.select2bs4').select2({
				theme: 'bootstrap4'
			})

		});
	</script>

	<script>
		// OnClick Eye Button
		function getInstructionOfUser(templateName, userName) {
			$.ajax({
				url : '/guac/getInstructionOfUser',
				type : 'GET',
				data : {
					templateName : templateName,
					userName : userName
				},
				success : function(response) {
					// 					alert("response :" + response)
					$("#instructionModalBody").html(response);
					$("#instructionModal").modal("show");
				},
				error : function(xhr, status, error) {
					$("#instructionModalBody").html(
							"<div class='alert alert-danger'>Error loading instructions: "
									+ error + "</div>");
					$("#instructionModal").modal("show");
				}
			});
		}

		function saveInstruction(templateName, userName) {
		    var instructions = [];

		    // Loop through all instruction groups
		    $("#instructionModalBody").find(".instruction-group").each(function () {
		        var id = $(this).data("id"); // take hidden id
		        var command = $(this).find("textarea.command").val();
		        var instructionDetails = $(this).find(".instruction-content").html();

		        instructions.push({
		            id: id,
		            command: command,
		            instructionDetails: instructionDetails
		        });
		    });

		    $.ajax({
		        url: '/guac/saveInstructionOfUser',
		        type: 'POST',
		        contentType: 'application/json',   // ✅ send JSON
		        data: JSON.stringify(instructions), // ✅ stringify
		        success: function (response) {
		            if (response === "success") {
		                Swal.fire({
		                    icon: 'success',
		                    title: 'Updated Successfully!',
		                    text: 'Instruction saved successfully!',
		                    showConfirmButton: false,
		                    timer: 2000
		                });
		                $("#instructionModal").modal("hide");
		            } else {
		                Swal.fire({
		                    icon: 'error',
		                    title: 'Failed',
		                    text: response
		                });
		            }
		        },
		        error: function (xhr, status, error) {
		            Swal.fire({
		                icon: 'error',
		                title: 'Error',
		                text: "Error while saving: " + error
		            });
		        }
		    });
		}

	</script>
</body>

</html>