<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head th:include="template :: headFragment(${pageTitle})">
<title>Add Scenario In Sub Playlist | Cyber Ranges</title>
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- Bootstrap Multiselect CSS -->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap-multiselect/dist/css/bootstrap-multiselect.css">

<style>
:root {
	--primary: #3498db;
	--secondary: #2c3e50;
	--light: #ecf0f1;
	--danger: #e74c3c;
}

body {
	background-color: #f5f7fa;
	font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

.card {
	border-radius: 8px;
	box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
	border: none;
}

.card-header {
	background-color: white;
	padding: 20px;
	border-radius: 8px 8px 0 0 !important;
}

.card-title {
	font-weight: 600;
	color: var(--secondary);
}

.form-control {
	border-radius: 6px;
	border: 1px solid #ddd;
	padding: 10px 15px;
}

.btn-primary {
	background-color: var(--primary);
	border-color: var(--primary);
	border-radius: 6px;
	padding: 10px 20px;
	font-weight: 500;
}

.required-field::after {
	content: "*";
	color: var(--danger);
	margin-left: 4px;
}
</style>
</head>

<body class="hold-transition sidebar-mini layout-fixed">
	<div class="wrapper">

		<div th:replace="fragments/header :: header"></div>
		<div th:replace="fragments/sidebar :: aside"></div>

		<div class="content-wrapper">

			<section class="content-header">
				<div class="container-fluid">
					<div class="row mb-2">
						<div class="col-sm-6">
							<h1>[[${pageTitle}]]</h1>
						</div>
						<div class="col-sm-6">
							<ol class="breadcrumb float-sm-right">
								<li class="breadcrumb-item"><a href="#"><i
										class="fas fa-home"></i> Home</a></li>
								<li class="breadcrumb-item active">Playlists</li>
							</ol>
						</div>
					</div>
				</div>
			</section>

			<section class="content">
				<div class="container-fluid">
					<div class="row">
						<div class="col-md-12">
							<div class="card">
								<div class="card-header">
									<h3 class="card-title">
										<i class="fas fa-list"></i> Add Scenario in Sub Playlist
									</h3>
								</div>

								<!-- FORM START -->
								<form th:action="@{/guac/save_ScenarioInSub_Playlist}"
									method="post" onsubmit="return validateForm()">

									<div class="card-body">
										<div class="row">
											<!-- Sub Playlist Dropdown -->
											<div class="col-md-6">
												<div class="form-group">
													<label for="existingSubPlaylist" class="required-field">Select
														Sub Playlist</label> <select id="existingSubPlaylist"
														name="subPlaylistId" class="form-control" required>
														<option value="">-- Select --</option>
														<option th:each="sub : ${subPlaylists}"
															th:value="${sub.id}" th:text="${sub.playlistName}"></option>
													</select>
												</div>
											</div>

											<!-- Scenarios Multi-select -->
											<div class="col-md-6">
												<div class="form-group">
													<label for="scenarios" class="required-field">Select
														Scenarios</label> <select id="scenarios" name="scenarioIds"
														class="form-control" multiple required>
														<option th:each="scenario : ${scenarios}"
															th:value="${scenario.id}"
															th:text="${scenario.scenarioTitle}"></option>
													</select>
												</div>
											</div>
										</div>
									</div>

									<!-- Footer Buttons -->
									<div class="card-footer text-right">
										<a href="#" class="btn btn-outline-secondary mr-2"><i
											class="fas fa-times mr-1"></i> Cancel</a>
										<button type="reset" class="btn btn-outline-secondary mr-2">
											<i class="fas fa-undo mr-1"></i> Reset
										</button>
										<button type="submit" id="saveBtn" class="btn btn-primary">
											<i class="fas fa-save mr-1"></i> Save <span id="spinner"
												class="spinner-border spinner-border-sm ml-2 d-none"></span>
										</button>
									</div>
								</form>
								<!-- FORM END -->

							</div>
						</div>
					</div>
				</div>
			</section>
		</div>

		<div th:replace="fragments/footer :: footer"></div>
	</div>

	<div th:replace="template :: jsscript"></div>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap-multiselect/dist/js/bootstrap-multiselect.min.js"></script>

	<script type="text/javascript">
		$(document).ready(function() {
			$('#scenarios').multiselect({
				includeSelectAllOption : true,
				enableFiltering : true,
				maxHeight : 250,
				buttonWidth : '100%'
			});
		});

		function validateForm() {
			let isValid = true;

			if (!$('#existingSubPlaylist').val()) {
				$('#existingSubPlaylist').addClass('is-invalid');
				isValid = false;
			}
			if (!$('#scenarios').val() || $('#scenarios').val().length === 0) {
				$('#scenarios').addClass('is-invalid');
				isValid = false;
			}

			if (!isValid) {
				$('html, body').animate({
					scrollTop : $('.is-invalid:first').offset().top - 100
				}, 500);
				return false;
			}

			$('#spinner').removeClass('d-none');
			$('#saveBtn').prop('disabled', true);
			return true;
		}
	</script>
</body>
</html>
