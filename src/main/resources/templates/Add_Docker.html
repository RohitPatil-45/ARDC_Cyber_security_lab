<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>Docker Network Discovery</title>
<head th:include="templateListing :: headFragment"></head>
<style>
.discovery-card {
	background: white;
	border-radius: 8px;
	box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
	padding: 25px;
	margin-bottom: 20px;
}

.discovery-header {
	margin-bottom: 25px;
	padding-bottom: 15px;
	border-bottom: 1px solid #eee;
}

.discovery-title {
	font-weight: 600;
	color: #2c3e50;
	font-size: 1.5rem;
}

.docker-icon {
	color: #2496ed;
	font-size: 24px;
	margin-right: 10px;
}

.form-label {
	font-weight: 500;
	color: #555;
	margin-bottom: 10px;
}

.select2-container--default .select2-selection--single {
	height: 45px;
	border-radius: 6px;
	border: 1px solid #ddd;
	padding: 10px;
}

.select2-container--default .select2-selection--single .select2-selection__arrow
	{
	height: 43px;
}

.btn-discover {
	background-color: #2496ed;
	border-color: #2496ed;
	border-radius: 6px;
	padding: 10px 20px;
	font-weight: 500;
	height: 45px;
	width: 100%;
}

.btn-discover:hover {
	background-color: #1d86d5;
	border-color: #1d86d5;
}

.results-container {
	margin-top: 30px;
	display: none;
}

.network-card {
	background-color: #f8f9fa;
	border-radius: 8px;
	padding: 20px;
	margin-bottom: 15px;
	border-left: 4px solid #2496ed;
}

.network-name {
	font-weight: 600;
	color: #2c3e50;
	margin-bottom: 5px;
}

.network-detail {
	color: #7f8c8d;
	font-size: 14px;
	margin-bottom: 3px;
}

.loading {
	display: none;
	text-align: center;
	margin: 20px 0;
}

.loading-spinner {
	color: #2496ed;
	font-size: 24px;
}

.ip-address-help {
	font-size: 13px;
	color: #6c757d;
	margin-top: 5px;
}
</style>
</head>
<body class="hold-transition sidebar-mini layout-fixed">
	<div class="wrapper">
		<div th:replace="fragments/header_bk :: header"></div>
		<div th:replace="fragments/sidebar :: aside"></div>

		<div class="content-wrapper">
			<section class="content-header">
				<div class="container-fluid">
					<div class="row mb-2">
						<div class="col-sm-6">
							<h1>Docker Network Discovery</h1>
						</div>
						<div class="col-sm-6">
							<ol class="breadcrumb float-sm-right">
								<li class="breadcrumb-item"><a href="#">Home</a></li>
								<li class="breadcrumb-item active">Docker Network Discovery</li>
							</ol>
						</div>
					</div>
				</div>
			</section>

			<section class="content">
				<div class="container-fluid">
					<div class="row">
						<div class="col-12">
							<div class="discovery-card">
								<div class="discovery-header">
									<h3 class="discovery-title">Discover Docker Networks</h3>
									<p>Select an IP address to discover Docker networks on the
										target host</p>
								</div>

								<form id="discoveryForm"
									th:action="@{/guac/savediscoverdokcerIpaddress}" method="post">
									<div class="form-group">
										<label class="form-label">IP Address</label> <select
											id="ipAddress" class="form-control" style="width: 100%"
											name="selectedIp">
											<option value="">-- Select IP Address --</option>
											<option th:each="ip : ${ipaddress}" th:value="${ip}"
												th:text="${ip}"></option>
										</select>
										<div class="ip-address-help">Select an IP address from
											the list or choose "Enter Custom IP"</div>
									</div>

									<div class="form-group" id="customIpContainer"
										style="display: none;">
										<label class="form-label">Custom IP Address</label> <input
											type="text" class="form-control" id="customIp"
											placeholder="Enter IP address (e.g., 192.168.1.150)">
									</div>

									<div class="form-group">
										<button type="submit" class="btn btn-discover">
											<i class="fas fa-search mr-2"></i> Discover Networks
										</button>
									</div>
								</form>


								<div class="loading" id="loadingIndicator">
									<div class="loading-spinner">
										<i class="fas fa-spinner fa-spin"></i>
									</div>
									<p>Discovering Docker networks...</p>
								</div>

								<div class="results-container" id="resultsContainer">
									<h4>Discovered Networks</h4>
									<div id="networkResults">
										<div>
											<h5>Available Docker Networks:</h5>
											<ul>
												<li th:each="net : ${networks}" th:text="${net}"></li>
											</ul>
										</div>
									</div>
								</div>

							</div>
						</div>
					</div>
			</section>
		</div>

		<div th:replace="fragments/footer :: footer"></div>
	</div>

	<div th:replace="templateListing :: jsscript"></div>

	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<script>
	document.getElementById('discoveryForm').addEventListener('submit', function (e) {
		const selectedIp = document.getElementById('ipAddress').value;
		const customIp = document.getElementById('customIp').value.trim();

		if (selectedIp === '') {
			Swal.fire({
				icon: 'warning',
				title: 'Missing IP Address',
				text: 'Please select an IP address or enter a custom IP.',
			});
			e.preventDefault();
			return;
		}

		if (selectedIp === 'custom' && customIp === '') {
			Swal.fire({
				icon: 'warning',
				title: 'Missing Custom IP',
				text: 'Please enter a custom IP address.',
			});
			e.preventDefault();
			return;
		}
	});
</script>


	<script>
		document.getElementById('ipAddress').addEventListener(
				'change',
				function() {
					const customIpContainer = document
							.getElementById('customIpContainer');
					if (this.value === 'custom') {
						customIpContainer.style.display = 'block';
					} else {
						customIpContainer.style.display = 'none';
					}
				});
	</script>


	<script th:inline="javascript">
    var vm_creationresult = [[${result}]];

    if (vm_creationresult == null || vm_creationresult === '') {
        // Do nothing
    } else if (vm_creationresult === 'success') {
        Swal.fire({
            position: "top",
            icon: "success",
            title: "Docker networks discovered successfully!",
            showConfirmButton: true
        });
    } else {
        Swal.fire({
            position: "top",
            icon: "warning",
            title: vm_creationresult,
            showConfirmButton: true
        });
    }
</script>



</body>
</html>