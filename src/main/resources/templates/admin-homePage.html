<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head th:include="template :: headFragment(${pageTitle})">
<title th:text="${pageTitle}">Admin Dashboard</title>
<link rel="icon" type="image/png" href="/webtemplate/dist/img/magicboxEye3.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<link rel="stylesheet" th:href="@{/css/dashboard.css}" />
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css">
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>

<style>
:root {
    --primary: #4361ee;
    --secondary: #3f37c9;
    --success: #4cc9f0;
    --danger: #f72585;
    --warning: #f8961e;
    --info: #4895ef;
    --dark: #2b2d42;
    --light: #f8f9fa;
}

.welcome-section {
    text-align: center;
    padding: 2rem 1rem;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    border-radius: 12px;
    color: white;
    margin-bottom: 2rem;
    position: relative;
    overflow: hidden;
}

.welcome-title {
    font-size: 2.5rem;
    font-weight: 800;
    line-height: 1;
    margin-bottom: 0.5rem;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.welcome-subtitle {
    font-size: 1.1rem;
    opacity: 0.9;
    font-weight: 500;
}

.stats-card {
    background: white;
    border-radius: 12px;
    padding: 1.5rem;
    text-align: center;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    margin-bottom: 1rem;
    border: none;
}

.stats-number {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    color: var(--primary);
}

.stats-label {
    font-size: 1rem;
    color: var(--gray);
    font-weight: 500;
}

.subject-badge {
    background: var(--light);
    color: var(--dark);
    padding: 0.3rem 0.6rem;
    border-radius: 15px;
    font-size: 0.8rem;
    margin: 0.1rem;
    display: inline-block;
    border: 1px solid #e9ecef;
}

.teacher-badge {
    background: #fff3cd;
    color: #856404;
    padding: 0.3rem 0.6rem;
    border-radius: 15px;
    font-size: 0.8rem;
    margin: 0.1rem;
    display: inline-block;
    border: 1px solid #ffeaa7;
}

.batch-badge {
    background: #d1ecf1;
    color: #0c5460;
    padding: 0.3rem 0.6rem;
    border-radius: 15px;
    font-size: 0.8rem;
    margin: 0.1rem;
    display: inline-block;
    border: 1px solid #bee5eb;
}
</style>

<body class="hold-transition sidebar-mini layout-fixed">
    <div class="wrapper">
        <div th:replace="fragments/header :: header"></div>
<!--         <div th:replace="fragments/sidebar :: aside"></div> -->
 <div th:replace="fragments/side-barAdmin :: aside"></div>

        <div class="content-wrapper">
            <!-- Header -->
            <section class="content-header">
                <div class="container-fluid">
                    <div class="row align-items-center mb-4">
                        <div class="col-sm-6">
                            <h1>
                                <i class="fas fa-user-shield mr-3"></i> 
                                <span th:text="${pageTitle}">Admin Dashboard</span>
                            </h1>
                        </div>
                        <div class="col-sm-6">
                            <ol class="breadcrumb float-sm-right">
                                <li class="breadcrumb-item"><a href="#">Home</a></li>
                                <li class="breadcrumb-item active" th:text="${pageTitle}">Admin Dashboard</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Main Content -->
            <section class="content">
                <div class="container-fluid">
                    
                    <!-- Welcome Section -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="welcome-section">
                                <div class="welcome-title" th:text="'Welcome, ' + ${admin?.name} + '!'">Welcome, Admin!</div>
                                <div class="welcome-subtitle" th:if="${department}" 
                                     th:text="'Managing: ' + ${department.departmentName} + ' Department'">
                                    Managing Department Operations
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Statistics Cards -->
                    

                    <!-- Error Message -->
                    <div th:if="${error}" class="alert alert-danger">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        <span th:text="${error}"></span>
                    </div>

                    <!-- Course Management Table -->
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="fas fa-table me-2"></i>Course Management
                                <span class="badge badge-primary ml-2" th:text="'Total: ' + ${courseDetails.size()}"></span>
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table id="courseTable" class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Course</th>
                                            <th>Semesters</th>
                                            <th>Batches</th>
                                            <th>Teachers</th>
                                            <th>Students</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr th:each="courseData, stat : ${courseDetails}">
                                            <td th:text="${stat.count}">1</td>
                                            
                                            <!-- Course -->
                                            <td>
                                                <strong th:text="${courseData.course.courseName}">Course Name</strong>
                                                <br>
                                                <small class="text-muted" th:text="${courseData.course.courseCode}">Course Code</small>
                                            </td>
                                            
                                            <!-- Semesters -->
                                            <td>
                                                <div th:each="semester : ${courseData.semesters}">
                                                    <span class="subject-badge" th:text="${semester.semesterName}">Semester</span>
                                                </div>
                                                <div th:if="${courseData.semesters.empty}">
                                                    <span class="text-muted">No Semesters</span>
                                                </div>
                                            </td>
                                            
                                            <!-- Batches -->
                                            <td>
                                                <div th:each="batch : ${courseData.batches}">
                                                    <span class="batch-badge" th:text="${batch.batchName}">Batch</span>
                                                </div>
                                                <div th:if="${courseData.batches.empty}">
                                                    <span class="text-muted">No Batches</span>
                                                </div>
                                            </td>
                                            
                                            <!-- Teachers -->
                                            <td>
                                                <div th:each="teacher : ${courseData.teachers}">
                                                    <span class="teacher-badge" th:text="${teacher}">Teacher</span>
                                                </div>
                                                <div th:if="${courseData.teachers.empty}">
                                                    <span class="text-muted">No Teachers</span>
                                                </div>
                                            </td>
                                            
                                            <!-- Students -->
                                            <td class="text-center">
                                                <span class="badge badge-primary" th:text="${courseData.studentCount}">0</span>
                                            </td>
                                            
                                            <!-- Actions -->
                                            <td class="text-center">
                                                <div class="btn-group">
                                                    <button class="btn btn-primary btn-sm" 
                                                            th:onclick="|viewCourseDetails(${courseData.course.courseId})|">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                    <button class="btn btn-success btn-sm"
                                                            th:onclick="|viewStudents(${courseData.course.courseId})|">
                                                        <i class="fas fa-users"></i>
                                                    </button>
                                                    <button class="btn btn-warning btn-sm"
                                                            th:onclick="|viewTeachers(${courseData.course.courseId})|">
                                                        <i class="fas fa-chalkboard-teacher"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>

                                        <!-- Empty State -->
                                        <tr th:if="${courseDetails.empty}">
                                            <td colspan="7" class="text-center py-5 text-muted">
                                                <i class="fas fa-inbox fa-2x mb-3"></i>
                                                <div>
                                                    <strong>No Courses Found</strong>
                                                    <p class="mb-0">No courses available in this department.</p>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <div th:replace="fragments/footer :: footer"></div>
    </div>

    <div th:replace="template :: jsscript"></div>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
    
    <script type="text/javascript">
        $(document).ready(function() {
            $('#courseTable').DataTable({
                "responsive": true,
                "lengthChange": true,
                "autoWidth": false,
                "pageLength": 10
            });
        });

        function viewCourseDetails(courseId) {
            window.location.href = '/guac/course-details/' + courseId;
        }

        function viewStudents(courseId) {
            window.location.href = '/guac/course-students/' + courseId;
        }

        function viewTeachers(courseId) {
            window.location.href = '/guac/course-teachers/' + courseId;
        }
    </script>
</body>
</html>