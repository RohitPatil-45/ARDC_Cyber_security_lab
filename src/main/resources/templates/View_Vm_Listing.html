<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head th:include="template :: headFragment(${pageTitle})">
<title>Create Playlist | Cyber Ranges</title>

<!-- Fonts & Icons -->
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link
	href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Roboto+Mono:wght@400;700&display=swap"
	rel="stylesheet">

<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


</head>
<style>
/* Professional Cyberpunk Theme with Blue Accents */
body {
	background-color: #1e293b;
	color: #e0e0e0;
	font-family: 'Poppins', sans-serif;
	margin: 0;
}

.content-wrapper {
	padding: 1rem;
}

h1, h3 {
	color: #2b7fff;
	font-weight: 600;
	text-shadow: 0 0 5px rgba(43, 127, 255, 0.3);
}

.card {
	background-color: #1a1a1a;
	border: 1px solid #2a2a2a;
	border-radius: 4px;
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
}

.card-header {
	border-bottom: 1px solid #2a2a2a;
	background: linear-gradient(to right, #151515, #1e1e1e);
}

.card-title {
	font-weight: 600;
	font-size: 1.2rem;
	color: #2b7fff;
}

.table th {
	background: linear-gradient(to bottom, #1a2b47, #152540);
	color: #2b7fff;
	border-bottom: 1px solid #2a2a2a;
	font-weight: 600;
	padding: 12px 15px;
}

.table td {
	vertical-align: middle;
	border-color: #2a2a2a;
	padding: 12px 15px;
	background-color: #1a1a1a;
	color: #d0d0d0;
}

.table-striped tbody tr:nth-of-type(odd) {
	background-color: #1e1e1e;
}

.table-hover tbody tr:hover {
	background-color: #252525;
}

.btn-cyber {
	background: linear-gradient(to bottom, #2b7fff, #1a5dd0);
	color: #fff;
	border: none;
	font-weight: 600;
	border-radius: 3px;
	padding: 8px 16px;
	transition: all 0.2s ease;
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.btn-cyber:hover {
	background: linear-gradient(to bottom, #3d8aff, #2470e0);
	color: #fff;
	transform: translateY(-1px);
	box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
}

.btn-success {
	background: linear-gradient(to bottom, #2b7fff, #1a5dd0);
	border: none;
	border-radius: 3px;
	padding: 6px 12px;
	font-size: 0.875rem;
	transition: all 0.2s ease;
}

.btn-success:hover {
	background: linear-gradient(to bottom, #3d8aff, #2470e0);
	transform: translateY(-1px);
}

.badge-info {
	background-color: #2b7fff;
	color: #fff;
	font-weight: 600;
	padding: 5px 10px;
	border-radius: 12px;
}

.breadcrumb {
	background-color: transparent;
	padding: 0;
	margin-bottom: 1rem;
}

.breadcrumb-item a {
	color: #2b7fff;
	text-decoration: none;
}

.breadcrumb-item.active {
	color: #a0a0a0;
}

.breadcrumb-item+.breadcrumb-item::before {
	color: #555;
}

.text-section {
	margin-bottom: 2rem;
	padding: 20px;
	background-color: #1a1a1a;
	border-radius: 4px;
	border-left: 4px solid #2b7fff;
}

.text-section h1 {
	margin-top: 0;
	font-size: 1.8rem;
}

.text-section p {
	line-height: 1.6;
	margin-bottom: 0.5rem;
	color: #d0d0d0;
}

/* Table responsiveness */
.table-responsive {
	overflow-x: auto;
	border-radius: 4px;
}

/* Content header improvements */
.content-header {
	margin-bottom: 1.5rem;
}

/* Card body padding */
.card-body {
	padding: 1.5rem;
}

/* SweetAlert customization */
.swal2-popup {
	background-color: #1a1a1a !important;
	color: #e0e0e0 !important;
	border: 1px solid #2a2a2a;
}

.swal2-title {
	color: #2b7fff !important;
}

.swal2-confirm {
	background: linear-gradient(to bottom, #2b7fff, #1a5dd0) !important;
}

/* Remove loader styles */
</style>
<body class="hold-transition sidebar-mini layout-fixed dark-mode">
	<div class="wrapper">

		<!-- Header & Sidebar -->
		<div th:replace="fragments/header :: header"></div>
		<div th:replace="fragments/sidebar :: aside"></div>

		<!-- Main Content -->
		<div class="content-wrapper">
			<section class="content-header">
				<div class="container-fluid">
					<div class="row mb-2">
						<div class="col-sm-6">
							<h1>[[${pageTitle}]]</h1>
						</div>
						<div class="col-sm-6">
							<ol class="breadcrumb float-sm-right">
								<li class="breadcrumb-item"><a href="#"><i
										class="fas fa-home"></i> Home</a></li>
								<li class="breadcrumb-item active">VM Connection</li>
							</ol>
						</div>
					</div>
				</div>
			</section>

			<!-- Lab Access Instructions -->
			<div class="row" style="margin-left: 1rem;">
				<div class="col-md-12">
					<div class="text-section">
						<h1>LAB ACCESS GUIDELINES</h1>
						<p>To support the completion of this scenario, you have access
							to a C2 Server running Kali Linux for receiving reverse
							connections.</p>
						<p>Browser-based access is provided via a web GUI service and
							SSH for Webshell access.</p>
					</div>
				</div>
			</div>

			<!-- Table and Instructions -->
			<section class="content">
				<div class="container-fluid">
					<div class="row">
						<div class="col-md-12">
							<div class="card">
								<div class="card-header">
									<h3 class="card-title">
										<i class="fas fa-network-wired"></i> Overview
									</h3>
								</div>
								<div class="card-body table-responsive" id="table-container">
									<table class="table table-bordered table-striped table-hover">
										<thead>
											<tr>
												<th>ID</th>
												<th>Lab Name</th>
												<th>IP Address</th>
												<th>UserName</th>
												<th>Status</th>
												<th>Completion %</th>
												<th>Actions</th>
											</tr>
										</thead>
										<tbody>
											<th:block th:if="${labData != null and !labData.empty}">
												<tr th:each="data : ${labData}">
													<td th:text="${data['lab'].labId}"></td>
													<td th:text="${data['lab'].instanceName}"></td>
													<td th:text="${data['lab'].ipAddress}"></td>
													<td th:text="${data['lab'].username}"></td>
													<td th:text="${data['lab'].Status}"></td>
													<td th:text="${data['percentage'] + '%'}"></td>
													
													<!-- 													<td><a -->
													<!-- 														th:href="@{|/guac/viewPlaylistConnection/${conn.guacamoleId}|}" -->
													<!-- 														class="btn btn-sm btn-success"> <i class="fas fa-play"></i> -->
													<!-- 															Console -->
													<!-- 													</a></td> -->
													
													<td>
														<button class="btn btn-sm btn-success"
															th:onclick="'startConnection(' + ${data['lab'].labId} + ')'">
															<i class="fas fa-play"></i> Start
														</button>
													</td>
												</tr>
											</th:block>

											<tr th:if="${labData == null or labData.empty}">
												<td colspan="7" class="text-muted text-center">No
													connection found.</td>
											</tr>
										</tbody>
									</table>



								</div>
							</div>
						</div>
					</div>
				</div>
			</section>
		</div>

		<!-- Footer -->
		<div th:replace="fragments/footer :: footer"></div>
	</div>

	<div th:replace="template :: jsscript"></div>

	<script>
		function startConnection(id) {

			// 			alert("idd :" + id);

			$.ajax({
				type : "POST",
				url : '/guac/startConnectionLab',
				data : {
					"UserLabId" : id

				},
				success : function(result) {
					// 					$("#pageLoader").hide();
					window.location = "/guac/viewPlaylistConnection/" + result;
					//alert(result);
				}
			});

			// 			window.location.href = '/guac/viewPlaylistConnection/'
			// 					+ guacamoleId;

		}
	</script>

</body>

</html>